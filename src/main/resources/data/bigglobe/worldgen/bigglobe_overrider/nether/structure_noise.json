{
	"type": "column_value",
	"script": [
		"float unmixSmoothD2F(int low, int high, int y:",
			"unmixSmooth(double(low), double(high), double(y)).as(float)",
		")",
		"for (StructureStart start in structures:",
			"if (",
				"start.structure.type == StructureType('minecraft:fortress') ||",
				"start.structure == Structure('minecraft:bastion_remnant')",
			":",
				"for (StructurePiece piece in start.pieces:",
					"float horizontalDistance = distanceToSquare(piece).as(float)",
					"if (horizontalDistance < 16.0I:",
						"horizontalDistance *= 0.0625I",
						"double bottomY = start.minY + 0.5L",
						"double fade = horizontalDistance ^ 2 * 16.0L",
						"double low = bottomY - fade",
						"double high = bottomY + fade",
						"for (int y in range(start.minY - 16, start.maxY + 16):",
							"float toAdd = (",
								"low == high",
								"? (y < bottomY ? 1.0I : -1.0I)",
								": unmixSmooth(high, low, double(y)).as(float) * 2.0I - 1.0I",
							")",
							"toAdd *= unmixSmoothD2F(start.minY - 16, start.minY, y)",
							"toAdd *= unmixSmoothD2F(start.maxY + 16, start.maxY, y)",
							"toAdd *= smooth(1.0I - horizontalDistance)",
							"`bigglobe:nether/bubble`.noise(y) += toAdd * 0.5I",
						")",
					")",
				")",
			")",
		")"
	]
}
{
	"type": "script",
	"params": {
		"type": "float",
		"is_3d": true
	},
	"script": [
		"float curve(float*(valueSquared, width):",
			"float curve = valueSquared / (valueSquared + width ^ 2)",
			"float bottomExclusion = float(unmixLinear(",
				"double(world_traits.`bigglobe:cave_min_y`) + width,",
				"double(world_traits.`bigglobe:cave_min_y`),",
				"double(y)",
			"))",
			"if (bottomExclusion > 0.0I: curve += bottomExclusion ^ 2)",
			"if (beach_cave_exclusion > 0.0I:",
				"float topExclusion = unmixLinear(",
					"world_traits.`bigglobe:exact_surface_y` - width * 2.0L,",
					"world_traits.`bigglobe:exact_surface_y`,",
					"y",
				")",
				".as(float)",
				"if (topExclusion > 0.0I: curve += topExclusion ^ 2 * beach_cave_exclusion)",
			")",
			"return(curve)",
		")",
		"float result = (",
			"curve(",
				"cave_primary_noise,",
				"mixLinear(",
					"8.0I,",
					"64.0I,",
					"unmixLinear(",
						"double(world_traits.`bigglobe:cave_max_y`),",
						"double(world_traits.`bigglobe:cave_min_y`),",
						"double(y)",
					")",
					".as(float)",
				")",
			")",
			"* curve(cave_secondary_noise, 8.0I)",
		")",
		"if (is_volcano: result += 1.0I - volcano_magma_sdf)",
		"result"
	],
	"valid": {
		"where": "hints.carve",
		"min_y": "world_traits.`bigglobe:cave_min_y`",
		"max_y": "world_traits.`bigglobe:cave_max_y`"
	}
}